{"version":3,"file":"call_rooms.js","mappings":";;UAAA;UACA;;;;;WCDA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;ACNA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,iDAAiD,cAAc,cAAc,QAAQ;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,yCAAyC;AAC5D;AACA;AACA,8DAA8D,sBAAsB,sBAAsB;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,CAAC;AACD,oFAAoF,MAAM;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACS","sources":["webpack://communications/webpack/bootstrap","webpack://communications/webpack/runtime/make namespace object","webpack://communications/./apps/calls/ts/scripts/call_rooms/main.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nconst room_id = location.pathname.split('/').at(-1);\nconst callRoomsWebSocket = new WebSocket(`ws://${location.host}/call-rooms/${room_id}`);\nconst localeVideo = document.querySelector('.video__current-user');\nconst remoteVideo = document.querySelector('.video__another-user');\nif (!localeVideo) {\n    throw Error('Not found locale video container!');\n}\nif (!remoteVideo) {\n    throw Error('Not found remote video container!');\n}\nlet localStream;\nlet remoteStream;\nconst servers = {\n    iceServers: [{ urls: ['stun:stun1.l.google.com:19302'] }],\n};\nconst createOffer = () => __awaiter(void 0, void 0, void 0, function* () {\n    localStream = yield navigator.mediaDevices.getUserMedia({ audio: true, video: { facingMode: 'user' } });\n    localeVideo.srcObject = localStream;\n    remoteStream = new MediaStream();\n    remoteVideo.srcObject = remoteStream;\n    const peerConnection = new RTCPeerConnection(servers);\n    localStream.getTracks().forEach((track) => {\n        peerConnection.addTrack(track);\n    });\n    peerConnection.ontrack = (event) => {\n        event.streams[0].getTracks().forEach((track) => {\n            remoteStream.addTrack(track);\n        });\n    };\n    peerConnection.onicecandidate = () => __awaiter(void 0, void 0, void 0, function* () {\n        console.log(peerConnection.localDescription);\n    });\n    const offer = yield peerConnection.createOffer();\n    yield peerConnection.setLocalDescription(offer);\n    console.log(offer);\n});\ncallRoomsWebSocket.onmessage = (_a) => __awaiter(void 0, [_a], void 0, function* ({ data }) {\n    const parsed_data = JSON.parse(data);\n    switch (parsed_data.type) {\n        case \"offer\" /* ActionType.offer */: {\n            yield createOffer();\n            break;\n        }\n    }\n});\nexport {};\n"],"names":[],"sourceRoot":""}