(()=>{"use strict";const o="notify",e=`${o}--active`,t=document.querySelector(`.${o}`);if(!t)throw Error("Not found notify container!");const r=t.querySelector(".notify__text");if(!r)throw Error("Not found notify text container!");const c=()=>t.classList.remove(e);let n;const a="dialog",s=`${a}--active`,i=document.querySelector(`.${a}`);if(!i)throw Error("Not found dialog container!");const l=i.querySelector(".dialog__text"),d=i.querySelector(".dialog__yes"),f=i.querySelector(".dialog__no");if(!l)throw Error("Not found dialog text container");if(!d)throw Error("Not found dialog success button");if(!f)throw Error("Not found dialog cancel button");const u=()=>i.classList.remove(s);window.callOffersWebSocket.addEventListener("message",(({data:o})=>{const a=JSON.parse(o);switch(a.type){case"offer.connection":{const o=a.data,e=JSON.stringify({type:"offer.cancel",data:o.id}),t=JSON.stringify({type:"offer.success",data:o.id});((o,e,t,r=1/0)=>{clearTimeout(void 0),l.textContent=o,i.classList.add(s),f.onclick=()=>{e(),u()},d.onclick=()=>{t(),u()},r!=1/0&&setTimeout(u,r)})(`You was offered by ${o.full_name}. Do you want take a call?`,(()=>window.callOffersWebSocket.send(e)),(()=>window.callOffersWebSocket.send(t)));break}case"offer.cancel":((o,a=1/0)=>{clearTimeout(n),r.textContent=o,t.classList.add(e),a!==1/0&&(n=setTimeout(c,a))})("Your call request was refused!",5e3);break;case"offer.success":{const o=a.data;window.location.href=`http://${window.location.host}/call-room/${o}`;break}}}))})();